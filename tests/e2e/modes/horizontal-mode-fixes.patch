Horizontal mode test fixes applied - all defensive checks added